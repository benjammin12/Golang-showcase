{{define "userHome"}}
{{template "head"}}

<div class="container user-page">
    <h2>Welcome to the page of tasks {{.}}</h2>
    <div id="tasks">
        <p>Here's all your tasks</p>
        <hr>
        <ul class="task-list">
        </ul>
    </div>

    <h3>Want to add a new task?</h3>
    <button type="button" class="btn btn-info" id="show-task-form">Add New Task</button><br>
    <div id="task-form">
        <input type="text" name="task-name" placeholder="Task Name"><br>
        <textarea name="task-additional" placeholder="Additional Task Info"></textarea>
        <button type="button" id="submit-task" class="btn btn-primary">Submit</button>
    </div>
</div>

<script>
    $( document ).ready(function() {
        $("#task-form").hide();
        getAllTasks();
    });

    $('#show-task-form').on('click',function(){
        if ($("#task-form").is(":visible")) {
            $("#task-form").hide();
        }else {
            $("#task-form").show();

        }
    });

    function getAllTasks() {
        $.ajax({
            url:"/tasks",
            type:"GET",
            success:function(resp){
                var jsonResp = JSON.parse(resp)
                var tasks = $('.task-list');
                tasks.empty();

                jsonResp.forEach(function(value){
                    var task = $("<li value=" + value.TaskId + ">" + value.TaskName + ":::" + value.TaskDesc +  "</li>")
                    tasks.append(task)
                });
            }
        })
    }
</script>
{{template "end"}}
{{end}}